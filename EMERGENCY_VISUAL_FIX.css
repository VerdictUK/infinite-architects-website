/* ═══════════════════════════════════════════════════════════════════════════
   EMERGENCY VISUAL FIX BLOCK
   Add this at the END of your <style> section, before </style>
   This overrides conflicting rules and fixes the major visual issues
   ═══════════════════════════════════════════════════════════════════════════ */

/* ═══════════════════════════════════════════════════════════════════════════
   1. REMOVE ALL FIXED HEIGHTS - Let content flow naturally
   ═══════════════════════════════════════════════════════════════════════════ */
.snap-section,
.section-inner,
[class*="-inner"],
[class*="-content"],
[class*="-container"]:not(.hero-book-container) {
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;
}

/* Sections should be at LEAST viewport height, but can expand */
.snap-section {
    min-height: 100vh !important;
    min-height: 100dvh !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   2. REMOVE OVERFLOW HIDDEN - Stop clipping content
   ═══════════════════════════════════════════════════════════════════════════ */
.snap-section,
.section-inner,
.ideas-section .section-inner,
.ideas-grid,
.evidence-grid,
.predictions-grid,
.evidence-locker-inner,
.hrih-content,
.religion-content,
[class*="-inner"],
[class*="-content"] {
    overflow: visible !important;
}

/* Only hide horizontal overflow on the main sections */
.snap-section {
    overflow-x: hidden !important;
    overflow-y: visible !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   3. FIX Z-INDEX STACKING - Proper layer order
   ═══════════════════════════════════════════════════════════════════════════ */

/* Background layers */
.mandelbrot-bg,
.neural-canvas,
.particle-canvas,
[class*="-bg"]:not(.mandelbrot-bg),
canvas {
    z-index: 0 !important;
    pointer-events: none !important;
}

/* Content layers */
.section-inner,
.hero-book-container,
[class*="-content"],
[class*="-container"]:not(.hero-book-container) {
    position: relative;
    z-index: 2 !important;
}

/* Interactive elements */
.hero-cta,
.cta-primary,
.idea-card,
.evidence-card,
button,
a {
    position: relative;
    z-index: 3 !important;
}

/* Navigation and overlays */
.nav,
.ticker {
    z-index: 100 !important;
}

.mobile-buy-bar {
    z-index: 1000 !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   4. FIX FLEXBOX ALIGNMENT - Consistent layout
   ═══════════════════════════════════════════════════════════════════════════ */

/* Default: center content */
.snap-section {
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
    align-items: center !important;
    gap: 1rem;
}

/* Sections with headers: align to top */
.ideas-section.snap-section,
.evidence-locker.snap-section,
.predictions-section.snap-section {
    justify-content: flex-start !important;
    padding-top: calc(var(--ticker-height, 40px) + var(--nav-height, 60px) + 2rem) !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   5. FIX GRID LAYOUTS - Proper card display
   ═══════════════════════════════════════════════════════════════════════════ */

/* Ideas grid - desktop */
.ideas-grid {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)) !important;
    gap: 1rem !important;
    width: 100% !important;
    max-width: 1400px !important;
}

/* Evidence grid - desktop */
.evidence-grid,
.evidence-locker .evidence-grid {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 1rem !important;
}

/* Predictions grid */
.predictions-grid {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
    gap: 1rem !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   6. FIX CARD VISIBILITY - Ensure all cards display properly
   ═══════════════════════════════════════════════════════════════════════════ */

.idea-card,
.evidence-card,
.prediction-card,
.expert-card {
    display: flex !important;
    flex-direction: column !important;
    padding: 1.5rem !important;
    background: rgba(4, 5, 15, 0.9) !important;
    border: 1px solid rgba(212, 168, 75, 0.15) !important;
    border-radius: 8px !important;
    min-height: 150px;
}

.idea-card--featured {
    grid-column: span 1 !important; /* Don't span multiple columns */
}

/* ═══════════════════════════════════════════════════════════════════════════
   7. FIX TYPOGRAPHY - Consistent text sizing
   ═══════════════════════════════════════════════════════════════════════════ */

.section-label {
    font-size: 0.75rem !important;
    letter-spacing: 0.2em !important;
    text-transform: uppercase !important;
    color: var(--gold, #d4a84b) !important;
    margin-bottom: 0.5rem !important;
}

.section-title {
    font-size: clamp(1.5rem, 4vw, 2.5rem) !important;
    line-height: 1.2 !important;
    margin-bottom: 1rem !important;
}

.section-subtitle {
    font-size: clamp(1rem, 2vw, 1.25rem) !important;
    line-height: 1.5 !important;
    color: var(--text-dim, rgba(240, 235, 227, 0.7)) !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   8. FIX BBC EVIDENCE CARD LAYOUT
   ═══════════════════════════════════════════════════════════════════════════ */

.bbc-evidence-card {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 2rem !important;
    align-items: center !important;
    max-width: 1200px !important;
    margin: 0 auto !important;
}

.bbc-evidence-card__video {
    width: 100% !important;
    max-height: 400px !important;
    border-radius: 8px !important;
}

.bbc-evidence-card__content {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   9. FIX HRIH SECTION
   ═══════════════════════════════════════════════════════════════════════════ */

.hrih-section .hrih-content {
    max-width: 1200px !important;
    margin: 0 auto !important;
    padding: 2rem !important;
}

.hrih-visual-wrapper {
    position: absolute !important;
    inset: 0 !important;
    z-index: 0 !important;
}

.hrih-visual {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    opacity: 0.5 !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   10. FIX RELIGION SECTION GRID
   ═══════════════════════════════════════════════════════════════════════════ */

.religion-section .religion-content,
.religion-section .section-inner {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 3rem !important;
    align-items: center !important;
    max-width: 1200px !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   11. MOBILE OVERRIDES - Clean mobile experience
   ═══════════════════════════════════════════════════════════════════════════ */

@media (max-width: 768px) {
    /* Remove snap behavior on mobile */
    html, body {
        scroll-snap-type: none !important;
    }
    
    /* Sections flow naturally */
    .snap-section {
        scroll-snap-align: none !important;
        min-height: auto !important;
        height: auto !important;
        padding: calc(var(--ticker-height, 40px) + var(--nav-height, 60px) + 1.5rem) 1rem 3rem !important;
    }
    
    /* Horizontal scroll for card grids */
    .ideas-grid,
    .predictions-grid {
        display: flex !important;
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        -webkit-overflow-scrolling: touch !important;
        scroll-snap-type: x mandatory !important;
        gap: 1rem !important;
        padding: 0.5rem 0 1.5rem !important;
    }
    
    .ideas-grid .idea-card,
    .predictions-grid .prediction-card {
        flex: 0 0 85vw !important;
        min-width: 280px !important;
        max-width: 320px !important;
        scroll-snap-align: center !important;
    }
    
    /* Evidence grid stacks */
    .evidence-grid,
    .evidence-locker .evidence-grid {
        grid-template-columns: 1fr 1fr !important;
        gap: 0.75rem !important;
    }
    
    /* BBC evidence stacks */
    .bbc-evidence-card {
        grid-template-columns: 1fr !important;
    }
    
    .bbc-evidence-card__video {
        max-height: 250px !important;
    }
    
    /* Religion section stacks */
    .religion-section .religion-content,
    .religion-section .section-inner {
        grid-template-columns: 1fr !important;
        gap: 2rem !important;
    }
    
    /* Smaller typography */
    .section-title {
        font-size: clamp(1.25rem, 5vw, 1.75rem) !important;
    }
    
    .section-subtitle {
        font-size: clamp(0.9rem, 3vw, 1.1rem) !important;
    }
    
    /* Show swipe hint */
    .swipe-hint {
        display: block !important;
        text-align: center;
        font-size: 0.7rem;
        color: var(--text-faint, rgba(240, 235, 227, 0.3));
        text-transform: uppercase;
        letter-spacing: 0.15em;
        margin-top: 0.75rem;
    }
}

/* ═══════════════════════════════════════════════════════════════════════════
   12. SMALL MOBILE (iPhone SE, etc.)
   ═══════════════════════════════════════════════════════════════════════════ */

@media (max-width: 375px) {
    .snap-section {
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
    }
    
    .evidence-grid,
    .evidence-locker .evidence-grid {
        grid-template-columns: 1fr !important;
    }
    
    .idea-card,
    .evidence-card {
        padding: 1rem !important;
    }
    
    .section-title {
        font-size: 1.25rem !important;
    }
}

/* ═══════════════════════════════════════════════════════════════════════════
   13. ENSURE CONTENT NEVER HIDDEN
   ═══════════════════════════════════════════════════════════════════════════ */

/* Force text to wrap, never overflow */
h1, h2, h3, h4, h5, h6, p, span, blockquote {
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

/* Ensure images don't break layout */
img {
    max-width: 100%;
    height: auto;
}

/* ═══════════════════════════════════════════════════════════════════════════
   14. PERFORMANCE OPTIMIZATIONS
   ═══════════════════════════════════════════════════════════════════════════ */

/* GPU acceleration for smooth animations */
.idea-card,
.evidence-card,
.hero-book,
.hero-cta {
    will-change: transform;
    transform: translateZ(0);
}

/* Disable heavy effects on mobile */
@media (max-width: 768px) {
    .neural-canvas,
    .particle-canvas,
    .film-grain,
    #canvas-container {
        display: none !important;
    }
    
    /* Simpler transitions */
    * {
        transition-duration: 0.2s !important;
    }
}
