/* ═══════════════════════════════════════════════════════════════════
   SECTION ANIMATION CONTAINMENT
   Ensure section-specific animations stay within their sections

   This file addresses the animation overflow issue by:
   1. Adding position: relative and overflow: hidden to section containers
   2. Ensuring animated elements use position: absolute within their sections
   3. Setting proper z-index hierarchy relative to section content
   4. Keeping global particle background as position: fixed, z-index: -10
   ═══════════════════════════════════════════════════════════════════ */

/* All major sections with animations - contain their animated children */
#hero,
#equation,
#ideas,
#evidence-locker,
#the-mind,
#chapters {
    position: relative;
    overflow: hidden;
    z-index: var(--z-content, 10);
}

/* ═══════════════════════════════════════════════════════════════════
   HERO SECTION CONTAINMENT
   ═══════════════════════════════════════════════════════════════════ */
#hero .mandelbrot-bg {
    position: absolute;
    inset: 0;
    z-index: 0;
    overflow: hidden;
}

#hero .mandelbrot-video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* ═══════════════════════════════════════════════════════════════════
   IDEAS SECTION CONTAINMENT
   ═══════════════════════════════════════════════════════════════════ */
#ideas #neural-canvas {
    position: absolute;
    inset: 0;
    z-index: 0;
    pointer-events: none;
}

#ideas .ideas-grid {
    position: relative;
    z-index: 1;
}

#ideas .section-inner {
    position: relative;
    z-index: 1;
}

/* ═══════════════════════════════════════════════════════════════════
   ABOUT/THE-MIND SECTION CONTAINMENT (Tesseract)
   ═══════════════════════════════════════════════════════════════════ */
#the-mind .tesseract-container {
    position: absolute;
    z-index: 1;
    overflow: hidden;
}

#the-mind #tesseract-canvas {
    position: absolute;
    inset: 0;
    z-index: 0;
    pointer-events: none;
}

#the-mind .about-inner,
#the-mind .section-inner {
    position: relative;
    z-index: 2;
}

/* ═══════════════════════════════════════════════════════════════════
   EQUATION SECTION CONTAINMENT
   ═══════════════════════════════════════════════════════════════════ */
#equation canvas,
.equation-section canvas {
    position: absolute;
    inset: 0;
    z-index: 0;
    pointer-events: none;
}

#equation .equation-container {
    position: relative;
    z-index: 1;
}

/* ═══════════════════════════════════════════════════════════════════
   EVIDENCE LOCKER SECTION CONTAINMENT
   ═══════════════════════════════════════════════════════════════════ */
#evidence-locker .evidence-grid {
    position: relative;
    z-index: 1;
}

#evidence-locker > div {
    position: relative;
    z-index: 1;
}

/* ═══════════════════════════════════════════════════════════════════
   CHAPTERS SECTION CONTAINMENT
   ═══════════════════════════════════════════════════════════════════ */
#chapters .chapters-grid,
#chapters [class*="grid"] {
    position: relative;
    z-index: 1;
}

#chapters > div {
    position: relative;
    z-index: 1;
}

/* ═══════════════════════════════════════════════════════════════════
   GLOBAL PARTICLE BACKGROUND
   MUST remain position: fixed to provide consistent backdrop
   ═══════════════════════════════════════════════════════════════════ */
#fluid-canvas {
    position: fixed !important;
    inset: 0 !important;
    z-index: var(--z-void, -10) !important;
    pointer-events: none !important;
}

/* ═══════════════════════════════════════════════════════════════════
   OVERRIDE TAILWIND overflow-visible CLASSES
   These sections were using overflow-visible which allowed animations
   to escape their containers
   ═══════════════════════════════════════════════════════════════════ */
section.overflow-visible#hero,
section.overflow-visible#equation,
section.overflow-visible#ideas,
section.overflow-visible#evidence-locker,
section.overflow-visible#the-mind,
section.overflow-visible#chapters {
    overflow: hidden !important;
}

/* ═══════════════════════════════════════════════════════════════════
   ENSURE SECTION CONTENT STAYS ABOVE BACKGROUND ANIMATIONS
   ═══════════════════════════════════════════════════════════════════ */
#hero > *:not(.mandelbrot-bg):not(canvas),
#equation > *:not(canvas),
#ideas > *:not(#neural-canvas):not(canvas),
#evidence-locker > *:not(canvas),
#the-mind > *:not(.tesseract-container):not(canvas),
#chapters > *:not(canvas) {
    position: relative;
    z-index: 1;
}

/* ═══════════════════════════════════════════════════════════════════
   ADDITIONAL CONTAINMENT FOR TRANSFORM-BASED ANIMATIONS
   Prevent any transformed elements from escaping section bounds
   ═══════════════════════════════════════════════════════════════════ */
#hero,
#equation,
#ideas,
#evidence-locker,
#the-mind,
#chapters {
    /* Contain paint operations to section boundaries */
    contain: paint;
    /* Ensure transforms don't escape */
    isolation: isolate;
}

/* ═══════════════════════════════════════════════════════════════════
   CARD ANIMATION CONTAINMENT
   Prevent card hover/reveal animations from escaping grid containers
   ═══════════════════════════════════════════════════════════════════ */
#ideas .idea-card,
#evidence-locker .evidence-card,
#chapters .chapter-card {
    position: relative;
    z-index: 1;
    /* Contain transform/opacity animations within card bounds */
    transform-style: flat;
}

/* Card hover states stay within bounds */
#ideas .idea-card:hover,
#evidence-locker .evidence-card:hover,
#chapters .chapter-card:hover {
    z-index: 2;
}

/* ═══════════════════════════════════════════════════════════════════
   SCROLL REVEAL ANIMATION CONTAINMENT
   Ensure reveal animations don't cause horizontal overflow
   ═══════════════════════════════════════════════════════════════════ */
.reveal,
[class*="reveal-"] {
    /* Prevent horizontal overflow during reveal animations */
    max-width: 100%;
}
